(()=>{"use strict";const e=THREE,t={type:"change"},i={type:"start"},r={type:"end"};class s extends e.EventDispatcher{constructor(s,n){super(),void 0===n&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),n===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=s,this.domElement=n,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new e.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:e.MOUSE.ROTATE,MIDDLE:e.MOUSE.DOLLY,RIGHT:e.MOUSE.PAN},this.touches={ONE:e.TOUCH.ROTATE,TWO:e.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return c.phi},this.getAzimuthalAngle=function(){return c.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(e){e.addEventListener("keydown",K),this._domElementKeyEvents=e},this.saveState=function(){o.target0.copy(o.target),o.position0.copy(o.object.position),o.zoom0=o.object.zoom},this.reset=function(){o.target.copy(o.target0),o.object.position.copy(o.position0),o.object.zoom=o.zoom0,o.object.updateProjectionMatrix(),o.dispatchEvent(t),o.update(),h=a.NONE},this.update=function(){const i=new e.Vector3,r=(new e.Quaternion).setFromUnitVectors(s.up,new e.Vector3(0,1,0)),n=r.clone().invert(),g=new e.Vector3,f=new e.Quaternion,b=2*Math.PI;return function(){const e=o.object.position;i.copy(e).sub(o.target),i.applyQuaternion(r),c.setFromVector3(i),o.autoRotate&&h===a.NONE&&T(2*Math.PI/60/60*o.autoRotateSpeed),o.enableDamping?(c.theta+=d.theta*o.dampingFactor,c.phi+=d.phi*o.dampingFactor):(c.theta+=d.theta,c.phi+=d.phi);let s=o.minAzimuthAngle,w=o.maxAzimuthAngle;return isFinite(s)&&isFinite(w)&&(s<-Math.PI?s+=b:s>Math.PI&&(s-=b),w<-Math.PI?w+=b:w>Math.PI&&(w-=b),c.theta=s<=w?Math.max(s,Math.min(w,c.theta)):c.theta>(s+w)/2?Math.max(s,c.theta):Math.min(w,c.theta)),c.phi=Math.max(o.minPolarAngle,Math.min(o.maxPolarAngle,c.phi)),c.makeSafe(),c.radius*=u,c.radius=Math.max(o.minDistance,Math.min(o.maxDistance,c.radius)),!0===o.enableDamping?o.target.addScaledVector(m,o.dampingFactor):o.target.add(m),i.setFromSpherical(c),i.applyQuaternion(n),e.copy(o.target).add(i),o.object.lookAt(o.target),!0===o.enableDamping?(d.theta*=1-o.dampingFactor,d.phi*=1-o.dampingFactor,m.multiplyScalar(1-o.dampingFactor)):(d.set(0,0,0),m.set(0,0,0)),u=1,!!(p||g.distanceToSquared(o.object.position)>l||8*(1-f.dot(o.object.quaternion))>l)&&(o.dispatchEvent(t),g.copy(o.object.position),f.copy(o.object.quaternion),p=!1,!0)}}(),this.dispose=function(){o.domElement.removeEventListener("contextmenu",X),o.domElement.removeEventListener("pointerdown",I),o.domElement.removeEventListener("pointercancel",Y),o.domElement.removeEventListener("wheel",W),o.domElement.removeEventListener("pointermove",j),o.domElement.removeEventListener("pointerup",N),null!==o._domElementKeyEvents&&o._domElementKeyEvents.removeEventListener("keydown",K)};const o=this,a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let h=a.NONE;const l=1e-6,c=new e.Spherical,d=new e.Spherical;let u=1;const m=new e.Vector3;let p=!1;const g=new e.Vector2,f=new e.Vector2,b=new e.Vector2,w=new e.Vector2,v=new e.Vector2,S=new e.Vector2,C=new e.Vector2,E=new e.Vector2,k=new e.Vector2,x=[],y={};function M(){return Math.pow(.95,o.zoomSpeed)}function T(e){d.theta-=e}function P(e){d.phi-=e}const A=function(){const t=new e.Vector3;return function(e,i){t.setFromMatrixColumn(i,0),t.multiplyScalar(-e),m.add(t)}}(),O=function(){const t=new e.Vector3;return function(e,i){!0===o.screenSpacePanning?t.setFromMatrixColumn(i,1):(t.setFromMatrixColumn(i,0),t.crossVectors(o.object.up,t)),t.multiplyScalar(e),m.add(t)}}(),R=function(){const t=new e.Vector3;return function(e,i){const r=o.domElement;if(o.object.isPerspectiveCamera){const s=o.object.position;t.copy(s).sub(o.target);let n=t.length();n*=Math.tan(o.object.fov/2*Math.PI/180),A(2*e*n/r.clientHeight,o.object.matrix),O(2*i*n/r.clientHeight,o.object.matrix)}else o.object.isOrthographicCamera?(A(e*(o.object.right-o.object.left)/o.object.zoom/r.clientWidth,o.object.matrix),O(i*(o.object.top-o.object.bottom)/o.object.zoom/r.clientHeight,o.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),o.enablePan=!1)}}();function L(e){o.object.isPerspectiveCamera?u/=e:o.object.isOrthographicCamera?(o.object.zoom=Math.max(o.minZoom,Math.min(o.maxZoom,o.object.zoom*e)),o.object.updateProjectionMatrix(),p=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),o.enableZoom=!1)}function U(e){o.object.isPerspectiveCamera?u*=e:o.object.isOrthographicCamera?(o.object.zoom=Math.max(o.minZoom,Math.min(o.maxZoom,o.object.zoom/e)),o.object.updateProjectionMatrix(),p=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),o.enableZoom=!1)}function z(e){g.set(e.clientX,e.clientY)}function D(e){w.set(e.clientX,e.clientY)}function B(){if(1===x.length)g.set(x[0].pageX,x[0].pageY);else{const e=.5*(x[0].pageX+x[1].pageX),t=.5*(x[0].pageY+x[1].pageY);g.set(e,t)}}function V(){if(1===x.length)w.set(x[0].pageX,x[0].pageY);else{const e=.5*(x[0].pageX+x[1].pageX),t=.5*(x[0].pageY+x[1].pageY);w.set(e,t)}}function G(){const e=x[0].pageX-x[1].pageX,t=x[0].pageY-x[1].pageY,i=Math.sqrt(e*e+t*t);C.set(0,i)}function H(e){if(1==x.length)f.set(e.pageX,e.pageY);else{const t=q(e),i=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);f.set(i,r)}b.subVectors(f,g).multiplyScalar(o.rotateSpeed);const t=o.domElement;T(2*Math.PI*b.x/t.clientHeight),P(2*Math.PI*b.y/t.clientHeight),g.copy(f)}function _(e){if(1===x.length)v.set(e.pageX,e.pageY);else{const t=q(e),i=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);v.set(i,r)}S.subVectors(v,w).multiplyScalar(o.panSpeed),R(S.x,S.y),w.copy(v)}function F(e){const t=q(e),i=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(i*i+r*r);E.set(0,s),k.set(0,Math.pow(E.y/C.y,o.zoomSpeed)),L(k.y),C.copy(E)}function I(t){!1!==o.enabled&&(0===x.length&&(o.domElement.setPointerCapture(t.pointerId),o.domElement.addEventListener("pointermove",j),o.domElement.addEventListener("pointerup",N)),function(e){x.push(e)}(t),"touch"===t.pointerType?function(t){switch(Z(t),x.length){case 1:switch(o.touches.ONE){case e.TOUCH.ROTATE:if(!1===o.enableRotate)return;B(),h=a.TOUCH_ROTATE;break;case e.TOUCH.PAN:if(!1===o.enablePan)return;V(),h=a.TOUCH_PAN;break;default:h=a.NONE}break;case 2:switch(o.touches.TWO){case e.TOUCH.DOLLY_PAN:if(!1===o.enableZoom&&!1===o.enablePan)return;o.enableZoom&&G(),o.enablePan&&V(),h=a.TOUCH_DOLLY_PAN;break;case e.TOUCH.DOLLY_ROTATE:if(!1===o.enableZoom&&!1===o.enableRotate)return;o.enableZoom&&G(),o.enableRotate&&B(),h=a.TOUCH_DOLLY_ROTATE;break;default:h=a.NONE}break;default:h=a.NONE}h!==a.NONE&&o.dispatchEvent(i)}(t):function(t){let r;switch(t.button){case 0:r=o.mouseButtons.LEFT;break;case 1:r=o.mouseButtons.MIDDLE;break;case 2:r=o.mouseButtons.RIGHT;break;default:r=-1}switch(r){case e.MOUSE.DOLLY:if(!1===o.enableZoom)return;!function(e){C.set(e.clientX,e.clientY)}(t),h=a.DOLLY;break;case e.MOUSE.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===o.enablePan)return;D(t),h=a.PAN}else{if(!1===o.enableRotate)return;z(t),h=a.ROTATE}break;case e.MOUSE.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===o.enableRotate)return;z(t),h=a.ROTATE}else{if(!1===o.enablePan)return;D(t),h=a.PAN}break;default:h=a.NONE}h!==a.NONE&&o.dispatchEvent(i)}(t))}function j(e){!1!==o.enabled&&("touch"===e.pointerType?function(e){switch(Z(e),h){case a.TOUCH_ROTATE:if(!1===o.enableRotate)return;H(e),o.update();break;case a.TOUCH_PAN:if(!1===o.enablePan)return;_(e),o.update();break;case a.TOUCH_DOLLY_PAN:if(!1===o.enableZoom&&!1===o.enablePan)return;!function(e){o.enableZoom&&F(e),o.enablePan&&_(e)}(e),o.update();break;case a.TOUCH_DOLLY_ROTATE:if(!1===o.enableZoom&&!1===o.enableRotate)return;!function(e){o.enableZoom&&F(e),o.enableRotate&&H(e)}(e),o.update();break;default:h=a.NONE}}(e):function(e){if(!1!==o.enabled)switch(h){case a.ROTATE:if(!1===o.enableRotate)return;!function(e){f.set(e.clientX,e.clientY),b.subVectors(f,g).multiplyScalar(o.rotateSpeed);const t=o.domElement;T(2*Math.PI*b.x/t.clientHeight),P(2*Math.PI*b.y/t.clientHeight),g.copy(f),o.update()}(e);break;case a.DOLLY:if(!1===o.enableZoom)return;!function(e){E.set(e.clientX,e.clientY),k.subVectors(E,C),k.y>0?L(M()):k.y<0&&U(M()),C.copy(E),o.update()}(e);break;case a.PAN:if(!1===o.enablePan)return;!function(e){v.set(e.clientX,e.clientY),S.subVectors(v,w).multiplyScalar(o.panSpeed),R(S.x,S.y),w.copy(v),o.update()}(e)}}(e))}function N(e){Q(e),0===x.length&&(o.domElement.releasePointerCapture(e.pointerId),o.domElement.removeEventListener("pointermove",j),o.domElement.removeEventListener("pointerup",N)),o.dispatchEvent(r),h=a.NONE}function Y(e){Q(e)}function W(e){!1!==o.enabled&&!1!==o.enableZoom&&h===a.NONE&&(e.preventDefault(),o.dispatchEvent(i),function(e){e.deltaY<0?U(M()):e.deltaY>0&&L(M()),o.update()}(e),o.dispatchEvent(r))}function K(e){!1!==o.enabled&&!1!==o.enablePan&&function(e){let t=!1;switch(e.code){case o.keys.UP:R(0,o.keyPanSpeed),t=!0;break;case o.keys.BOTTOM:R(0,-o.keyPanSpeed),t=!0;break;case o.keys.LEFT:R(o.keyPanSpeed,0),t=!0;break;case o.keys.RIGHT:R(-o.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),o.update())}(e)}function X(e){!1!==o.enabled&&e.preventDefault()}function Q(e){delete y[e.pointerId];for(let t=0;t<x.length;t++)if(x[t].pointerId==e.pointerId)return void x.splice(t,1)}function Z(t){let i=y[t.pointerId];void 0===i&&(i=new e.Vector2,y[t.pointerId]=i),i.set(t.pageX,t.pageY)}function q(e){const t=e.pointerId===x[0].pointerId?x[1]:x[0];return y[t.pointerId]}o.domElement.addEventListener("contextmenu",X),o.domElement.addEventListener("pointerdown",I),o.domElement.addEventListener("pointercancel",Y),o.domElement.addEventListener("wheel",W,{passive:!1}),this.update()}}const n={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor.a *= opacity;\n\n\n\t\t}"};class o{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}const a=new e.OrthographicCamera(-1,1,1,-1,0,1),h=new e.BufferGeometry;h.setAttribute("position",new e.Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3)),h.setAttribute("uv",new e.Float32BufferAttribute([0,2,0,0,2,0],2));class l{constructor(t){this._mesh=new e.Mesh(h,t)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,a)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class c extends o{constructor(t,i){super(),this.textureID=void 0!==i?i:"tDiffuse",t instanceof e.ShaderMaterial?(this.uniforms=t.uniforms,this.material=t):t&&(this.uniforms=e.UniformsUtils.clone(t.uniforms),this.material=new e.ShaderMaterial({defines:Object.assign({},t.defines),uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader})),this.fsQuad=new l(this.material)}render(e,t,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}}class d extends o{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,i){const r=e.getContext(),s=e.state;let n,o;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0),this.inverse?(n=0,o=1):(n=1,o=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),s.buffers.stencil.setFunc(r.ALWAYS,n,4294967295),s.buffers.stencil.setClear(o),s.buffers.stencil.setLocked(!0),e.setRenderTarget(i),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(r.EQUAL,1,4294967295),s.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),s.buffers.stencil.setLocked(!0)}}class u extends o{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class m{constructor(t,i){if(this.renderer=t,void 0===i){const r=t.getSize(new e.Vector2);this._pixelRatio=t.getPixelRatio(),this._width=r.width,this._height=r.height,(i=new e.WebGLRenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=i.width,this._height=i.height;this.renderTarget1=i,this.renderTarget2=i.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===n&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===c&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new c(n),this.clock=new e.Clock}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){void 0===e&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let i=!1;for(let t=0,r=this.passes.length;t<r;t++){const r=this.passes[t];if(!1!==r.enabled){if(r.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(t),r.render(this.renderer,this.writeBuffer,this.readBuffer,e,i),r.needsSwap){if(i){const t=this.renderer.getContext(),i=this.renderer.state.buffers.stencil;i.setFunc(t.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),i.setFunc(t.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==d&&(r instanceof d?i=!0:r instanceof u&&(i=!1))}}this.renderer.setRenderTarget(t)}reset(t){if(void 0===t){const i=this.renderer.getSize(new e.Vector2);this._pixelRatio=this.renderer.getPixelRatio(),this._width=i.width,this._height=i.height,(t=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=t,this.renderTarget2=t.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const i=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(i,r),this.renderTarget2.setSize(i,r);for(let e=0;e<this.passes.length;e++)this.passes[e].setSize(i,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}}new e.OrthographicCamera(-1,1,1,-1,0,1);const p=new e.BufferGeometry;p.setAttribute("position",new e.Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3)),p.setAttribute("uv",new e.Float32BufferAttribute([0,2,0,0,2,0],2));class g extends o{constructor(t,i,r,s,n){super(),this.scene=t,this.camera=i,this.overrideMaterial=r,this.clearColor=s,this.clearAlpha=void 0!==n?n:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new e.Color}render(e,t,i){const r=e.autoClear;let s,n;e.autoClear=!1,void 0!==this.overrideMaterial&&(n=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),s=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:i),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,s),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=n),e.autoClear=r}}const f={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new e.Color(0)},defaultOpacity:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec3 defaultColor;\n\t\tuniform float defaultOpacity;\n\t\tuniform float luminosityThreshold;\n\t\tuniform float smoothWidth;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\n\t\t\tvec3 luma = vec3( 0.299, 0.587, 0.114 );\n\n\t\t\tfloat v = dot( texel.xyz, luma );\n\n\t\t\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n\n\t\t\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n\n\t\t\tgl_FragColor = mix( outputColor, texel, alpha );\n\n\t\t}"};class b extends o{constructor(t,i,r,s){super(),this.strength=void 0!==i?i:1,this.radius=r,this.threshold=s,this.resolution=void 0!==t?new e.Vector2(t.x,t.y):new e.Vector2(256,256),this.clearColor=new e.Color(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let o=Math.round(this.resolution.x/2),a=Math.round(this.resolution.y/2);this.renderTargetBright=new e.WebGLRenderTarget(o,a),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let t=0;t<this.nMips;t++){const i=new e.WebGLRenderTarget(o,a);i.texture.name="UnrealBloomPass.h"+t,i.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(i);const r=new e.WebGLRenderTarget(o,a);r.texture.name="UnrealBloomPass.v"+t,r.texture.generateMipmaps=!1,this.renderTargetsVertical.push(r),o=Math.round(o/2),a=Math.round(a/2)}void 0===f&&console.error("THREE.UnrealBloomPass relies on LuminosityHighPassShader");const h=f;this.highPassUniforms=e.UniformsUtils.clone(h.uniforms),this.highPassUniforms.luminosityThreshold.value=s,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new e.ShaderMaterial({uniforms:this.highPassUniforms,vertexShader:h.vertexShader,fragmentShader:h.fragmentShader,defines:{}}),this.separableBlurMaterials=[];const c=[3,5,7,9,11];o=Math.round(this.resolution.x/2),a=Math.round(this.resolution.y/2);for(let t=0;t<this.nMips;t++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(c[t])),this.separableBlurMaterials[t].uniforms.texSize.value=new e.Vector2(o,a),o=Math.round(o/2),a=Math.round(a/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=i,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0,this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new e.Vector3(1,1,1),new e.Vector3(1,1,1),new e.Vector3(1,1,1),new e.Vector3(1,1,1),new e.Vector3(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,void 0===n&&console.error("THREE.UnrealBloomPass relies on CopyShader");const d=n;this.copyUniforms=e.UniformsUtils.clone(d.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new e.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:d.vertexShader,fragmentShader:d.fragmentShader,blending:e.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new e.Color,this.oldClearAlpha=1,this.basic=new e.MeshBasicMaterial,this.fsQuad=new l(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose()}setSize(t,i){let r=Math.round(t/2),s=Math.round(i/2);this.renderTargetBright.setSize(r,s);for(let t=0;t<this.nMips;t++)this.renderTargetsHorizontal[t].setSize(r,s),this.renderTargetsVertical[t].setSize(r,s),this.separableBlurMaterials[t].uniforms.texSize.value=new e.Vector2(r,s),r=Math.round(r/2),s=Math.round(s/2)}render(e,t,i,r,s){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const n=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),s&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=i.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=i.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let o=this.renderTargetBright;for(let t=0;t<this.nMips;t++)this.fsQuad.material=this.separableBlurMaterials[t],this.separableBlurMaterials[t].uniforms.colorTexture.value=o.texture,this.separableBlurMaterials[t].uniforms.direction.value=b.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[t]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[t].uniforms.colorTexture.value=this.renderTargetsHorizontal[t].texture,this.separableBlurMaterials[t].uniforms.direction.value=b.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[t]),e.clear(),this.fsQuad.render(e),o=this.renderTargetsVertical[t];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,s&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(i),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=n}getSeperableBlurMaterial(t){return new e.ShaderMaterial({defines:{KERNEL_RADIUS:t,SIGMA:t},uniforms:{colorTexture:{value:null},texSize:{value:new e.Vector2(.5,.5)},direction:{value:new e.Vector2(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec2 direction;\n\n\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\n\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n\t\t\t\t}\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tfloat fSigma = float(SIGMA);\n\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\n\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\n\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = float(i);\n\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\n\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\n\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\n\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\n\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\n\t\t\t\t\t\tweightSum += 2.0 * w;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})}getCompositeMaterial(t){return new e.ShaderMaterial({defines:{NUM_MIPS:t},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\t\t\t\tuniform sampler2D blurTexture1;\n\t\t\t\tuniform sampler2D blurTexture2;\n\t\t\t\tuniform sampler2D blurTexture3;\n\t\t\t\tuniform sampler2D blurTexture4;\n\t\t\t\tuniform sampler2D blurTexture5;\n\t\t\t\tuniform float bloomStrength;\n\t\t\t\tuniform float bloomRadius;\n\t\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\n\t\t\t\tfloat lerpBloomFactor(const in float factor) {\n\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\n\t\t\t\t}"})}}b.BlurDirectionX=new e.Vector2(1,0),b.BlurDirectionY=new e.Vector2(0,1);const w=new e.MeshBasicMaterial({color:0}),v=class{static blackOut(e){e.traverse((function(e){e.isObject3D&&e.material&&(e.userData.originMaterial=e.material,e.material=w)}))}static lightUp(e){e.traverse((function(e){e.isObject3D&&e.userData.originMaterial&&(e.material=e.userData.originMaterial)}))}constructor(t,i,r,s){const n=new g(t,i),o=new e.Vector2;r.getSize(o);const a=new b(o,1,0,0);this.bloomComposer=new m(r),this.bloomComposer.renderToScreen=!1,this.bloomComposer.addPass(n),this.bloomComposer.addPass(a);const h=new c(new e.ShaderMaterial({uniforms:{baseTexture:{value:null},bloomTexture:{value:this.bloomComposer.renderTarget2.texture}},vertexShader:s.vertex,fragmentShader:s.fragment,defines:{}}),"baseTexture");h.needsSwap=!0,this.finalComposer=new m(r),this.finalComposer.addPass(n),this.finalComposer.addPass(h)}setSize(e,t){this.bloomComposer.setSize(e,t),this.finalComposer.setSize(e,t)}render(e,t){e(),this.bloomComposer.render(),t(),this.finalComposer.render()}},S=Object.freeze({R:{hex:16711680,code:"F00"},G:{hex:65280,code:"0F0"},B:{hex:255,code:"00F"},Y:{hex:16776960,code:"FF0"},F:{hex:16711935,code:"F0F"},C:{hex:65535,code:"0FF"},W:{hex:16777215,code:"FFF"}}),C={CylinderGeometry:e.CylinderGeometry,Group:e.Group,MathUtils:e.MathUtils,Mesh:e.Mesh,MeshPhysicalMaterial:e.MeshPhysicalMaterial,RectAreaLight:e.RectAreaLight,Vector3:e.Vector3},E=S.C.hex,k=new C.MeshPhysicalMaterial({roughness:0,reflectivity:1}),x=new C.Vector3(0,-1,0),y=new C.Vector3(0,1,0),M=C.MathUtils.degToRad(15),T=k.clone();T.color.setHex(11513775);const P=new C.MeshPhysicalMaterial({roughness:1,color:0});function A(e,t,i){let r=!1;const s=i.length/2;for(let n=0,o=s-1;n<s;o=n++){const s=i[2*n],a=i[2*n+1],h=i[2*o],l=i[2*o+1];a>t!=l>t&&e<(h-s)*(t-a)/(l-a)+s&&(r=!r)}return r}class O extends C.Group{constructor(e,t,i){super(),this.isGlowStick=!0,this.color=void 0===t?E:t,this.size=void 0===e?1:e,this.segment=void 0===i?16:i,this.shakeOffset=0,this.speed=1,this.isGlowing=!1,this.tube=null,this.handler=null,this.lights=[],this.addItem=this.add.bind(this),this.removeItem=this.remove.bind(this),this.init()}init(){const e=new C.CylinderGeometry(this.size,this.size,8*this.size,this.segment),t=k.clone();t.color.setHex(this.color),this.tube=new C.Mesh(e,t);const i=Math.sin(90*Math.PI/this.segment)*this.size,r=8*this.size,s=e.getAttribute("normal");for(let e=0;e<this.segment;++e){const t=s.getX(e),n=s.getZ(e),o=new C.RectAreaLight(this.color,3,i,r);this.lights.push(o),o.position.set(-t,r,-n),o.lookAt(t,r,n)}const n=.9*this.size,o=new C.CylinderGeometry(n,n,4*this.size,this.segment),a=T.clone();this.handler=new C.Mesh(o,a),this.tube.position.set(0,8*this.size,0),this.tube.castShadow=!0,this.tube.receiveShadow=!0,this.handler.position.set(0,2*this.size,0),this.handler.castShadow=!0,this.handler.receiveShadow=!0,this.add(this.tube),this.add(this.handler),this.rotateX(-Math.PI/12)}glow(e){e?this.lights.forEach(this.addItem):this.lights.forEach(this.removeItem)}darken(){v.blackOut(this.handler)}lighten(){v.lightUp(this.handler)}getSize(){return this.size}getColor(){return this.color}changeColor(e){this.color=e,this.tube.material.color.setHex(e),this.lights.forEach((function(t){t.color.setHex(e)}))}changeSpeed(e){this.speed=e}shake(){0!==this.speed&&(this.shakeOffset+=.1*this.speed,this.rotateX(Math.sin(this.shakeOffset)/24))}}class R extends C.Group{constructor(e,t,i){super(),this.isGlowStickPair=!0,this.color=void 0===t?E:t,this.size=void 0===e?1:e,this.segment=void 0===i?16:i,this.left=null,this.right=null,this.init()}init(){this.left=new O(this.size,this.color,this.segment),this.right=new O(this.size,this.color,this.segment),this.left.position.set(5*this.left.size,0,0),this.left.rotateOnAxis(x,M),this.right.position.set(5*-this.right.size,0,0),this.right.rotateOnAxis(y,M),this.add(this.left),this.add(this.right),this.lookAt(0,0,0)}glow(e){this.traverse((function(t){t.isObject3D&&t.isGlowStick&&t.glow(e)}))}getSize(){return this.left.getSize()}getColor(){return this.left.getColor()}darken(){this.left.darken(),this.right.darken()}lighten(){this.left.lighten(),this.right.lighten()}changeColor(e){this.left.changeColor(e),this.right.changeColor(e)}changeSpeed(e){this.left.changeSpeed(e),this.right.changeSpeed(e)}shake(){this.left.shake(),this.right.shake()}}class L extends C.Group{constructor(e,t,i,r,s=!0){super(),this.isGlowStickGroup=!0,this.stickNumber=Math.max(e,1),this.uniform=s,this.color=void 0===i?E:i,this.size=void 0===t?1:t,this.segment=void 0===r?16:r,this.sample=null,this.init()}init(){for(let e=0;e<this.stickNumber;++e){const t=new O(this.size,this.color,this.segment);this.add(t),0==e?this.sample=t:this.uniform&&(delete t.tube.material,delete t.handler.material,t.tube.material=this.sample.tube.material,t.handler.material=this.sample.handler.material)}}glow(e){this.traverse((function(t){t.isObject3D&&t.isGlowStick&&t.glow(e)}))}getSize(){return this.sample.getSize()}getColor(){return this.sample.getColor()}darken(){this.uniform?this.sample.handler.material.copy(P):this.traverse((function(e){e.isObject3D&&e.isGlowStick&&e.darken()}))}lighten(){this.uniform?this.sample.handler.material.copy(T):this.traverse((function(e){e.isObject3D&&e.isGlowStick&&e.lighten()}))}changeColor(e){this.uniform?this.sample.changeColor(e):this.traverse((function(t){t.isObject3D&&t.isGlowStick&&t.changeColor(e)}))}changeSpeed(e){this.traverse((function(t){t.isObject3D&&t.isGlowStick&&t.changeSpeed(e)}))}shake(){this.traverse((function(e){e.isObject3D&&e.isGlowStick&&e.shake()}))}addStick(e,t){let i=new O(this.size,this.color,this.segment);this.add(i),i.position.set(e,0,t)}audienceLookAt(e,t,i){this.traverse((function(r){r.isObject3D&&r.isGlowStick&&r.lookAt(e,t,i)}))}distribute(e){const t=e.getAttribute("position"),i=t.array.filter(((e,t)=>t%3!=2)),r=t.array.filter(((e,t)=>t%3==0)),s=t.array.filter(((e,t)=>t%3==1)),n=Math.max(...r),o=Math.min(...r),a=-Math.max(...s),h=-Math.min(...s),l=n-o,c=a-h;this.traverse((function(e){if(e.isObject3D&&e.isGlowStick){let t=Math.random()*l+o,r=Math.random()*c+h,s=0;for(;!A(t,-r,i)&&s<15;)t=Math.random()*l+o,r=Math.random()*c+h,s++;e.position.set(t,0,r)}}))}}class U{constructor(){this.groups={}}add(e,t){this.groups[e]=t}get(e){return this.groups[e]}glow(e){Object.values(this.groups).forEach((t=>{t.glow(e)}))}darken(){Object.values(this.groups).forEach((e=>{e.darken()}))}lighten(){Object.values(this.groups).forEach((e=>{e.lighten()}))}changeSpeed(e){Object.values(this.groups).forEach((t=>{t.changeSpeed(e)}))}shake(){Object.values(this.groups).forEach((e=>{e.shake()}))}}let z={bloom:!1,glow:!1};const D=e=>document.getElementById(e),B=Object.freeze({vertex:D("vertexShader").textContent,fragment:D("fragmentShader").textContent}),V=new e.Euler(0,0,0,"YXZ"),G=new e.Vector3,H={type:"change"},_={type:"lock"},F={type:"unlock"},I=Math.PI/2;class j extends e.EventDispatcher{constructor(t,i){super(),void 0===i&&(console.warn('THREE.PointerLockControls: The second parameter "domElement" is now mandatory.'),i=document.body),this.domElement=i,this.isLocked=!1,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.pointerSpeed=1;const r=this;function s(e){if(!1===r.isLocked)return;const i=e.movementX||e.mozMovementX||e.webkitMovementX||0,s=e.movementY||e.mozMovementY||e.webkitMovementY||0;V.setFromQuaternion(t.quaternion),V.y-=.002*i*r.pointerSpeed,V.x-=.002*s*r.pointerSpeed,V.x=Math.max(I-r.maxPolarAngle,Math.min(I-r.minPolarAngle,V.x)),t.quaternion.setFromEuler(V),r.dispatchEvent(H)}function n(){r.domElement.ownerDocument.pointerLockElement===r.domElement?(r.dispatchEvent(_),r.isLocked=!0):(r.dispatchEvent(F),r.isLocked=!1)}function o(){console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}this.connect=function(){r.domElement.ownerDocument.addEventListener("mousemove",s),r.domElement.ownerDocument.addEventListener("pointerlockchange",n),r.domElement.ownerDocument.addEventListener("pointerlockerror",o)},this.disconnect=function(){r.domElement.ownerDocument.removeEventListener("mousemove",s),r.domElement.ownerDocument.removeEventListener("pointerlockchange",n),r.domElement.ownerDocument.removeEventListener("pointerlockerror",o)},this.dispose=function(){this.disconnect()},this.getObject=function(){return t},this.getDirection=function(){const i=new e.Vector3(0,0,-1);return function(e){return e.copy(i).applyQuaternion(t.quaternion)}}(),this.moveForward=function(e){G.setFromMatrixColumn(t.matrix,0),G.crossVectors(t.up,G),t.position.addScaledVector(G,e)},this.moveRight=function(e){G.setFromMatrixColumn(t.matrix,0),t.position.addScaledVector(G,e)},this.lock=function(){this.domElement.requestPointerLock()},this.unlock=function(){r.domElement.ownerDocument.exitPointerLock()},this.connect()}}let N={bloom:!1,target:new e.Vector3(0,0,-50),eye:new e.Vector3(0,36,50),sight:new e.Vector3,areaSticks:60};N.sight.subVectors(N.target,N.eye);const Y=Object.freeze({clf:[S.R,S.G,S.B,S.Y,S.F,S.C],crf:[S.G,S.B,S.Y,S.F,S.C,S.R],crb:[S.B,S.Y,S.F,S.C,S.R,S.G],clb:[S.Y,S.F,S.C,S.R,S.G,S.B],l:[S.F,S.C,S.R,S.G,S.B,S.Y],r:[S.C,S.R,S.G,S.B,S.Y,S.F]}),W=Object.freeze({clf:[[0,0],[0,80],[120,80],[80,0]],crf:[[0,0],[-80,0],[-120,80],[0,80]],crb:[[0,80],[-120,80],[-160,160],[0,160]],clb:[[0,80],[0,160],[160,160],[120,80]],l:[[80,0],[160,160],[240,80],[100,-20]],r:[[-80,0],[-100,-20],[-240,80],[-160,160]]}),K=Object.freeze({floor:{color:4338470,path:[[80,0],[-80,0],[-100,-20],[-100,-100],[100,-100],[100,-20]]}}),X=e=>document.getElementById(e),Q=Object.freeze({vertex:X("vertexShader").textContent,fragment:X("fragmentShader").textContent});let Z={moveUp:!1,moveDown:!1,moveLeft:!1,moveRight:!1,top:new e.Vector3(0,1,0),vertical:new e.Vector3(1,0,0),colorAnchor:1};function q(t){let i,r,s,n=0;for(let e=0;e<t.length;++e){const o=t[e];if(o.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(void 0===i&&(i=o.array.constructor),i!==o.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===r&&(r=o.itemSize),r!==o.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===s&&(s=o.normalized),s!==o.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;n+=o.array.length}const o=new i(n);let a=0;for(let e=0;e<t.length;++e)o.set(t[e].array,a),a+=t[e].array.length;return new e.BufferAttribute(o,r,s)}let $=[[0,0],[1,0],[1,2.5],[1.5,2.5],[1.5,3.5],[2,3.5],[2,3.833]],J=[1.5,1.75,2,2.5,3],ee=[new e.Color(25496),new e.Color(38508)],te=[new e.Vector2(1,0),new e.Vector2(.5,.5*Math.sqrt(3)),new e.Vector2(-.5,.5*Math.sqrt(3)),new e.Vector2(-1,0),new e.Vector2(-.5,.5*-Math.sqrt(3)),new e.Vector2(.5,.5*-Math.sqrt(3))];class ie extends e.EllipseCurve{getPoint(t,i=new e.Vector3){const r=super.getPoint(t);return i.set(r.x,r.y,0)}}class re extends e.Group{constructor(t,i,r){super(),this.isGlowStick=!0,this.color=void 0===i?S.W.hex:i,this.size=void 0===t?2:t,this.segment=void 0===r?32:r,this.colorOffset=0,this.shakeOffset=0,this.speed=1,this.head=new e.Group,this.ring=new e.Group,this.earth=null,this.galaxy=null,this.bulb=null,this.handler=null,this.init()}init(){const t=.5*this.size,i=1.2*this.size,r=new e.MeshPhysicalMaterial({metalness:0,roughness:.2,color:16777215,side:e.DoubleSide});let s=[];for(let r=0;r<$.length;++r)s.push(new e.Vector2($[r][0]*t,$[r][1]*i));const n=new e.LatheGeometry(s,this.segment);this.handler=new e.Mesh(n,r);const o=new e.SphereGeometry(J[0]*t,this.segment,this.segment),a=new e.MeshPhysicalMaterial({roughness:0,color:ee[0]});this.earth=new e.Mesh(o,a);const h=new e.SphereGeometry(J[4]*t,this.segment,this.segment),l=new e.MeshPhysicalMaterial({roughness:0,transmission:.9,opacity:0,thickness:.1*t,color:16777215});this.galaxy=new e.Mesh(h,l);const c=new e.MeshPhysicalMaterial({color:16777215,metalness:.9,roughness:.1}),d=.5*(J[1]+J[2])*t,u=.5*(J[2]-J[1])*t,m=new ie(0,0,d,d,0,Math.PI),p=new e.TubeGeometry(m,this.segment,u,te.length),g=new e.Mesh(p,c),f=.5*(J[1]+J[3])*t,b=.5*(J[3]-J[1])*t,w=new ie(0,0,f,f,0,Math.PI),v=new e.TubeGeometry(w,this.segment,b,te.length),S=new e.Shape(te),C=new e.ShapeGeometry(S),E=C.clone();C.scale(b,b,b),C.rotateZ(Math.PI/6),C.translate(f,0,0),C.rotateX(Math.PI/2),E.scale(b,b,b),E.rotateZ(Math.PI/6),E.translate(-f,0,0),E.rotateX(Math.PI/2);const k=function(t,i=!1){const r=null!==t[0].index,s=new Set(Object.keys(t[0].attributes)),n=new Set(Object.keys(t[0].morphAttributes)),o={},a={},h=t[0].morphTargetsRelative,l=new e.BufferGeometry;let c=0;for(let e=0;e<t.length;++e){const d=t[e];let u=0;if(r!==(null!==d.index))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+e+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const t in d.attributes){if(!s.has(t))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+e+'. All geometries must have compatible attributes; make sure "'+t+'" attribute exists among all geometries, or in none of them.'),null;void 0===o[t]&&(o[t]=[]),o[t].push(d.attributes[t]),u++}if(u!==s.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+e+". Make sure all geometries have the same number of attributes."),null;if(h!==d.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+e+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const t in d.morphAttributes){if(!n.has(t))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+e+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===a[t]&&(a[t]=[]),a[t].push(d.morphAttributes[t])}if(l.userData.mergedUserData=l.userData.mergedUserData||[],l.userData.mergedUserData.push(d.userData),i){let t;if(r)t=d.index.count;else{if(void 0===d.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+e+". The geometry must have either an index or a position attribute"),null;t=d.attributes.position.count}l.addGroup(c,t,e),c+=t}}if(r){let e=0;const i=[];for(let r=0;r<t.length;++r){const s=t[r].index;for(let t=0;t<s.count;++t)i.push(s.getX(t)+e);e+=t[r].attributes.position.count}l.setIndex(i)}for(const e in o){const t=q(o[e]);if(!t)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+e+" attribute."),null;l.setAttribute(e,t)}for(const e in a){const t=a[e][0].length;if(0===t)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[e]=[];for(let i=0;i<t;++i){const t=[];for(let r=0;r<a[e].length;++r)t.push(a[e][r][i]);const r=q(t);if(!r)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+e+" morphAttribute."),null;l.morphAttributes[e].push(r)}}return l}([v,C,E],!1),x=new e.Mesh(k,c);g.receiveShadow=!0,g.castShadow=!0,g.rotation.z=.5*-Math.PI,x.receiveShadow=!0,x.castShadow=!0,x.rotation.z=.5*Math.PI,this.ring.add(g),this.ring.add(x),this.earth.castShadow=!0,this.head.add(this.earth),this.head.add(this.ring),this.head.add(this.galaxy);let y=J[4]*t;this.bulb=new e.PointLight(this.color,5,10*y);const M=2*s[s.length-1].x,T=s.map((e=>e.y)),P=Math.max(...T)-Math.min(...T)+Math.sqrt(Math.pow(y,2)-Math.pow(.5*M,2));this.head.position.set(0,P,0),this.bulb.castShadow=!0,this.bulb.position.set(0,.8*P,0),this.handler.castShadow=!0,this.add(this.head),this.add(this.bulb),this.add(this.handler)}glow(){}darken(){v.blackOut(this.handler),v.blackOut(this.ring),this.galaxy.visible=!1}lighten(){this.galaxy.visible=!0,v.lightUp(this.handler),v.lightUp(this.head)}getSize(){return this.size}getColor(){return this.color}changeColor(e){this.color=e,this.bulb.color.setHex(e)}changeSpeed(e){this.speed=e}shake(){this.colorOffset+=.02;const e=.5*Math.sin(this.colorOffset)+.5;this.earth.material.color.lerpColors(ee[0],ee[1],e),0!==this.speed&&(this.shakeOffset+=.2*this.speed,this.rotateX(Math.sin(this.shakeOffset)/30),this.ring.rotation.y+=Math.PI/30*this.speed)}}const se=re;let ne={bloom:!1};const oe={AmbientLight:e.AmbientLight,Color:e.Color,Mesh:e.Mesh,MeshPhysicalMaterial:e.MeshPhysicalMaterial,PerspectiveCamera:e.PerspectiveCamera,PlaneGeometry:e.PlaneGeometry,Scene:e.Scene,SpotLight:e.SpotLight,VSMShadowMap:e.VSMShadowMap,WebGLRenderer:e.WebGLRenderer},ae=e=>document.getElementById(e),he=Object.freeze({vertex:ae("vertexShader").textContent,fragment:ae("fragmentShader").textContent});let le,ce={WithUs:new class{constructor(){this.onChangeSpeed=this.onChangeSpeed.bind(this),this.onChangeColor=this.onChangeColor.bind(this),this.onResize=this.onResize.bind(this),this.blackOut=this.blackOut.bind(this),this.lightUp=this.lightUp.bind(this),this.render=this.render.bind(this)}init(){this.renderer=new oe.WebGLRenderer({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=oe.VSMShadowMap,this.renderer.autoClear=!1,this.scene=new oe.Scene,this.scene.userData.backgroundColor=3355443,this.scene.background=new oe.Color(this.scene.userData.backgroundColor),this.camera=new oe.PerspectiveCamera(45,window.innerWidth/window.innerHeight,.1,1e3),this.camera.position.set(15,15,20),this.camera.lookAt(this.scene.position),this.controls=new s(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.dampingFactor=.25,this.renderPipe=new v(this.scene,this.camera,this.renderer,he),this.glowSticks=new se,this.glowSticks.position.set(0,4*-this.glowSticks.getSize(),0),this.scene.add(this.glowSticks);const e=new oe.PlaneGeometry(200,200),t=new oe.MeshPhysicalMaterial({color:11184810});this.plane=new oe.Mesh(e,t),this.plane.rotation.x=-.5*Math.PI,this.plane.position.set(0,8*-this.glowSticks.getSize(),0),this.plane.receiveShadow=!0,this.scene.add(this.plane);const i=new oe.AmbientLight(4473924);this.scene.add(i);const r=new oe.SpotLight(14540253,.7);r.position.set(0,30,20),r.castShadow=!0,r.penumbra=.3,r.shadow.camera.near=10,r.shadow.camera.far=200,r.shadow.radius=4,r.shadow.bias=-.02,r.target=this.glowSticks,this.scene.add(r)}blackOut(){v.blackOut(this.plane),this.glowSticks.darken(),this.scene.background.set(0)}lightUp(){v.lightUp(this.plane),this.glowSticks.lighten(),this.scene.background.set(this.scene.userData.backgroundColor)}render(){this.controls.update(),this.glowSticks.shake(),ne.bloom?this.renderPipe.render(this.blackOut,this.lightUp):this.renderer.render(this.scene,this.camera),this.renderer.setAnimationLoop(this.render)}onResize(e){this.camera.aspect=e.target.innerWidth/e.target.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(e.target.innerWidth,e.target.innerHeight),this.renderPipe.setSize(e.target.innerWidth,e.target.innerHeight)}refreshSelected(e){[...e.parentElement.children].forEach((function(t){t===e?t.setAttribute("lmu-selected",1):t.removeAttribute("lmu-selected")}))}onChangeSpeed(e){const t=parseInt(e.target.value);this.glowSticks.changeSpeed(t),this.refreshSelected(e.target)}onChangeColor(e){const t=e.target.value;this.glowSticks.changeColor(t),this.refreshSelected(e.target)}initPanel(){this.blockSpeed=document.createElement("div");let e=document.createElement("span");e.innerText="Speed",this.blockSpeed.appendChild(e);for(let e=0;e<3;++e){let t=document.createElement("button");t.innerText=`${e}x`,t.value=e,t.addEventListener("click",this.onChangeSpeed),this.blockSpeed.appendChild(t)}this.blockColor=document.createElement("div");let t=document.createElement("span");t.innerText="Color",this.blockColor.appendChild(t);for(const e in S){let t=document.createElement("button");t.innerText=S[e].code,t.value=S[e].hex,t.addEventListener("click",this.onChangeColor),this.blockColor.appendChild(t)}this.blockEffect=document.createElement("div");let i=document.createElement("span");i.innerText="Effect",this.blockEffect.appendChild(i);let r=document.createElement("label"),s=document.createElement("input");s.type="checkbox",s.id="checkBloom",s.addEventListener("change",(function(e){ne.bloom=e.target.checked})),r.appendChild(s),r.htmlFor=s.id;let n=document.createTextNode("Bloom");r.appendChild(n),this.blockEffect.appendChild(r)}setUp(){this.blockSpeed||this.initPanel(),this.renderer||this.init(),window.addEventListener("resize",this.onResize),document.body.appendChild(this.renderer.domElement);const e=ae("panel");e.appendChild(this.blockSpeed),e.appendChild(this.blockColor),e.appendChild(this.blockEffect),this.render()}cleanUp(){window.removeEventListener("resize",this.onResize);const e=ae("panel");e.removeChild(this.blockColor),e.removeChild(this.blockEffect),e.removeChild(this.blockSpeed),document.body.removeChild(this.renderer.domElement),this.renderer.setAnimationLoop(null)}},OnStage:new class{constructor(){this.rotate=this.rotate.bind(this),this.onResize=this.onResize.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.blackOut=this.blackOut.bind(this),this.lightUp=this.lightUp.bind(this),this.render=this.render.bind(this)}init(){this.renderer=new e.WebGLRenderer({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=e.PCFSoftShadowMap,this.renderer.toneMappingExposure=Math.pow(1,4),this.renderer.autoClear=!1,this.scene=new e.Scene,this.scene.userData.backgroundColor=0,this.scene.background=new e.Color(this.scene.userData.backgroundColor),this.camera=new e.PerspectiveCamera(45,window.innerWidth/window.innerHeight,.1,1e3),this.camera.position.copy(N.eye),this.camera.lookAt(N.target),this.renderPipe=new v(this.scene,this.camera,this.renderer,Q),this.controls=new j(this.camera,this.renderer.domElement),this.controls.movementSpeed=1,this.controls.lookSpeed=.1,this.glowAreas=[],this.glowSticks=new U;const t=new e.MeshPhysicalMaterial({color:394758});for(const i in W){const r=W[i].map((t=>new e.Vector2(...t))),s=new e.ShapeGeometry(new e.Shape(r)),n=new e.Mesh(s,t.clone());n.rotation.x=-.5*Math.PI,n.position.set(0,-1,0),n.receiveShadow=!0,this.scene.add(n),this.glowAreas.push(n);const o=Y[i][0].hex,a=new L(N.areaSticks,.5,o,8);a.changeSpeed(3),a.distribute(s),a.audienceLookAt(0,0,N.eye.z),this.scene.add(a),this.glowSticks.add(i,a)}const i=K.floor.path.map((t=>new e.Vector2(...t))),r=new e.ShapeGeometry(new e.Shape(i)),s=new e.MeshPhysicalMaterial({color:K.floor.color,roughness:.5});this.floor=new e.Mesh(r,s.clone()),this.floor.rotation.x=-.5*Math.PI,this.floor.position.set(0,0,0),this.floor.receiveShadow=!0,this.scene.add(this.floor);const n=new e.AmbientLight(6710886);this.scene.add(n);for(let t=0;t<3;++t){const i=new e.PointLight(16777215,5,80);i.castShadow=!0,i.position.set(40*t-40,40,50),this.scene.add(i)}}blackOut(){for(const e in this.glowAreas)v.blackOut(this.glowAreas[e]);v.blackOut(this.floor),this.glowSticks.darken(),this.scene.background.set(0)}lightUp(){for(const e in this.glowAreas)v.lightUp(this.glowAreas[e]);v.lightUp(this.floor),this.glowSticks.lighten(),this.scene.background.set(this.scene.userData.backgroundColor)}render(){this.glowSticks.shake();let e,t,i;Z.moveLeft?(e=.02,t=Z.top,i=Z.vertical):Z.moveRight?(e=-.02,t=Z.top,i=Z.vertical):Z.moveUp?(e=.02,t=Z.vertical):Z.moveDown&&(e=-.02,t=Z.vertical),t&&(N.sight.applyAxisAngle(t,e),N.target.addVectors(N.eye,N.sight),i&&i.applyAxisAngle(t,e),this.camera.lookAt(N.target)),this.renderer.clear(),N.bloom?this.renderPipe.render(this.blackOut,this.lightUp):this.renderer.render(this.scene,this.camera),this.renderer.setAnimationLoop(this.render)}onResize(e){this.camera.aspect=e.target.innerWidth/e.target.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(e.target.innerWidth,e.target.innerHeight),this.renderPipe.setSize(e.target.innerWidth,e.target.innerHeight)}onKeyDown(e){switch(e.code){case"ArrowUp":case"KeyW":Z.moveUp=!0;break;case"ArrowDown":case"KeyS":Z.moveDown=!0;break;case"ArrowLeft":case"KeyA":Z.moveLeft=!0;break;case"ArrowRight":case"KeyD":Z.moveRight=!0}}onKeyUp(e){switch(e.code){case"ArrowUp":case"KeyW":Z.moveUp=!1;break;case"ArrowDown":case"KeyS":Z.moveDown=!1;break;case"ArrowLeft":case"KeyA":Z.moveLeft=!1;break;case"ArrowRight":case"KeyD":Z.moveRight=!1}}rotate(){for(const e in W)this.glowSticks.get(e).changeColor(Y[e][Z.colorAnchor].hex);Z.colorAnchor++,Z.colorAnchor>=6&&(Z.colorAnchor=0)}initPanel(){this.blockInstruct=document.createElement("div"),this.blockInstruct.innerText="Keyboard: [W/Up] [S/Down] [A/Left] [D/Right]",this.blockEffect=document.createElement("div");let e=document.createElement("span");e.innerText="Effect",this.blockEffect.appendChild(e);let t=document.createElement("label"),i=document.createElement("input");i.type="checkbox",i.id="checkBloom",i.addEventListener("change",(function(e){N.bloom=e.target.checked})),t.appendChild(i),t.htmlFor=i.id;let r=document.createTextNode("Bloom");t.appendChild(r),this.blockEffect.appendChild(t)}setUp(){this.blockSpeed||this.initPanel(),this.renderer||this.init(),window.addEventListener("resize",this.onResize),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.onKeyUp),document.body.appendChild(this.renderer.domElement),this.interval=window.setInterval(this.rotate,1500);const e=X("panel");e.appendChild(this.blockInstruct),e.appendChild(this.blockEffect),this.render()}cleanUp(){window.removeEventListener("resize",this.onResize),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),X("panel").textContent="",this.interval&&window.clearInterval(this.interval),document.body.removeChild(this.renderer.domElement),this.renderer.setAnimationLoop(null)}},InCrowd:new class{constructor(){this.onChangeSpeed=this.onChangeSpeed.bind(this),this.onChangeColor=this.onChangeColor.bind(this),this.onVideoPlay=this.onVideoPlay.bind(this),this.onVideoPause=this.onVideoPause.bind(this),this.onResize=this.onResize.bind(this),this.onCheckGlow=this.onCheckGlow.bind(this),this.onCheckBloom=this.onCheckBloom.bind(this),this.blackOut=this.blackOut.bind(this),this.lightUp=this.lightUp.bind(this),this.render=this.render.bind(this)}init(){this.renderer=new e.WebGLRenderer({alpha:!0,antialias:!0}),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=e.VSMShadowMap,this.renderer.autoClear=!1,this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight),this.scene=new e.Scene,this.scene.userData.backgroundColor=0,this.scene.background=new e.Color(this.scene.userData.backgroundColor),this.camera=new e.PerspectiveCamera(45,window.innerWidth/window.innerHeight,.1,1e3),this.camera.position.set(20,20,30),this.camera.lookAt(this.scene.position),this.controls=new s(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.dampingFactor=.25,this.renderPipe=new v(this.scene,this.camera,this.renderer,B),this.glowSticks=new R,this.glowSticks.position.set(0,3*-this.glowSticks.getSize(),0),this.scene.add(this.glowSticks);const t=new e.PlaneGeometry(160,160),i=new e.MeshPhysicalMaterial({color:13421772});this.plane=new e.Mesh(t,i),this.plane.rotation.x=-.5*Math.PI,this.plane.position.set(0,6*-this.glowSticks.getSize(),-10),this.plane.receiveShadow=!0,this.scene.add(this.plane);const r=new e.AmbientLight(4473924);this.scene.add(r);const n=new e.SpotLight(14540253,.7);n.position.set(0,30,20),n.castShadow=!0,n.penumbra=.3,n.shadow.camera.near=10,n.shadow.camera.far=200,n.shadow.radius=4,n.shadow.bias=-.02,n.target=this.glowSticks,this.scene.add(n);const o=D("video");if(!o)return;const a=new e.VideoTexture(o),h=new e.MeshBasicMaterial({color:16777215,map:a,side:e.FrontSide,toneMapped:!1}),l=o.videoHeight/o.videoWidth,c=new e.PlaneGeometry(160,160*l);this.screen=new e.Mesh(c,h),this.screen.rotation.y=Math.PI,this.screen.position.set(0,160*l/2,80),this.scene.add(this.screen)}blackOut(){v.blackOut(this.plane),v.blackOut(this.screen),this.glowSticks.darken(),this.scene.background.set(0)}lightUp(){v.lightUp(this.plane),v.lightUp(this.screen),this.glowSticks.lighten(),this.scene.background.set(this.scene.userData.backgroundColor)}render(){this.controls.update(),this.glowSticks.shake(),z.bloom?this.renderPipe.render(this.blackOut,this.lightUp):this.renderer.render(this.scene,this.camera),this.renderer.setAnimationLoop(this.render)}refreshSelected(e){[...e.parentElement.children].forEach((function(t){t===e?t.setAttribute("lmu-selected",1):t.removeAttribute("lmu-selected")}))}onResize(e){this.camera.aspect=e.target.innerWidth/e.target.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(e.target.innerWidth,e.target.innerHeight),this.renderPipe.setSize(e.target.innerWidth,e.target.innerHeight)}onChangeSpeed(e){const t=parseInt(e.target.value);this.glowSticks.changeSpeed(t),this.refreshSelected(e.target)}onChangeColor(e){const t=e.target.value;this.glowSticks.changeColor(t),this.refreshSelected(e.target)}onVideoPlay(e){const t=D("video");t&&(t.play(),this.camera.position.set(0,0,-50),this.controls.target=this.screen.position),this.refreshSelected(e.target)}onVideoPause(e){const t=D("video");t&&(t.pause(),this.controls.target=this.scene.position),this.refreshSelected(e.target)}onCheckGlow(e){z.glow=e.target.checked,this.glowSticks.glow(z.glow)}onCheckBloom(e){z.bloom=e.target.checked}initPanel(){this.blockSpeed=document.createElement("div");let e=document.createElement("span");e.innerText="Speed",this.blockSpeed.appendChild(e);for(let e=0;e<3;++e){let t=document.createElement("button");t.innerText=`${e}x`,t.value=e,t.addEventListener("click",this.onChangeSpeed),this.blockSpeed.appendChild(t)}this.blockColor=document.createElement("div");let t=document.createElement("span");t.innerText="Color",this.blockColor.appendChild(t);for(const e in S){let t=document.createElement("button");t.innerText=S[e].code,t.value=S[e].hex,t.addEventListener("click",this.onChangeColor),this.blockColor.appendChild(t)}this.blockEffect=document.createElement("div");let i=document.createElement("span");i.innerText="Effect",this.blockEffect.appendChild(i);let r=document.createElement("label"),s=document.createElement("input");s.type="checkbox",s.id="checkBloom",s.addEventListener("change",this.onCheckBloom),r.appendChild(s),r.htmlFor=s.id;let n=document.createTextNode("Bloom");r.appendChild(n),this.blockEffect.appendChild(r);let o=document.createElement("label"),a=document.createElement("input");a.type="checkbox",a.id="checkGlow",a.addEventListener("change",this.onCheckGlow),o.appendChild(a),o.htmlFor=a.id;let h=document.createTextNode("Glow");o.appendChild(h),this.blockEffect.appendChild(o),this.blockVideo=document.createElement("div");let l=document.createElement("span");l.innerText="Video",this.blockVideo.appendChild(l);let c=document.createElement("button");c.innerText="Play",c.addEventListener("click",this.onVideoPlay),this.blockVideo.appendChild(c);let d=document.createElement("button");d.innerText="Pause",d.addEventListener("click",this.onVideoPause),this.blockVideo.appendChild(d)}setUp(){this.blockSpeed||this.initPanel(),this.renderer||this.init(),window.addEventListener("resize",this.onResize),document.body.appendChild(this.renderer.domElement);const e=D("panel");e.appendChild(this.blockSpeed),e.appendChild(this.blockColor),e.appendChild(this.blockEffect),e.appendChild(this.blockVideo),this.render()}cleanUp(){window.removeEventListener("resize",this.onResize);const e=D("panel");e.removeChild(this.blockColor),e.removeChild(this.blockEffect),e.removeChild(this.blockSpeed),e.removeChild(this.blockVideo);const t=D("video");t&&t.pause(),document.body.removeChild(this.renderer.domElement),this.renderer.setAnimationLoop(null)}}};document.querySelectorAll("#nav > a").forEach((function(e){e.addEventListener("click",(function(e){switch(le&&le.cleanUp(),e.target.href.split("#")[1]){case"WithUs":le=ce.WithUs;break;case"OnStage":le=ce.OnStage;break;default:le=ce.InCrowd}le.setUp()}))})),window.addEventListener("load",(function(e){window.location.hash&&(le=ce[window.location.hash.replace("#","")]),le||(le=ce.InCrowd),le.setUp()}))})();